# Ответы на вопросы к защите лабораторной работы

## 1. Платформа Java EE. Спецификации и их реализации.

**Java EE (Java Enterprise Edition)** представляет собой платформу для создания корпоративных приложений на языке Java. Прежде всего это сфера веб-приложений и веб-сервисов.

Основные спецификации:
* Java Servlets: серверные модули, которые обрабатывают запросы от пользователей и отправляют результат обработки.
* JavaServer Pages (JSP): серверные модули для обработки пользовательских запросов (по сути предствляют собой страницы с кодом HTML/JavaScript/CSS с вкраплениями кода на Java).
* Enterprise JavaBeans (EJB): Java классы, которые содержат бизнес-логику.
* Contexts and Dependency Injection (CDI): механизм для внедрения и управления зависимостями.
* JavaServer Faces (JSF): служит для создания пользовательского интерфейса на стороне сервера.
* Java API for RESTful Web Services (JAX-RS): API для применения архитектуры REST в приложениях.

Основные реализации:
* Wildfly
* Glassfish

## 2. Принципы IoC, CDI и Location Transpanency. Компоненты и контейнеры.

**Inversion of Control** - это принцип для написания слабо связанного кода. То есть такого кода, что каждый компонент системы должен быть как можно более изолированным от других, не используя реализации других компонентов.

**Внедрение зависимостей (Dependency Injection)** - это стиль настройки объекта, при котором поля объекта задаются внешней сущностью. Другими словами, объекты настраиваются внешними объектами. 

Пример внедрения зависимостей:
```java
public class MartinRaila {

  // В данном случае мы самостоятельно управляем зависимостью (создаем ее).
  private Dependency someDependency = new Dependency();
  
}
```
Перепишем код с использованием принципа внедрения зависимостей.
```java
public class MartinRaila {

  private Dependency someDependency;

  // Теперь мы принимаем зависимость извне, что избавляет компонент от необходимости ею управлять
  public MartinRaila(Dependency someDependency) {
    this.someDependency = someDependency;
  }
  
}  
```

Существует 3 типа внедрения зависимостей:
* Field injection: инъекция напрямую в поле.
* Constructor injection: инъекция конструктор (как показано в примере выше).
* Setter injection: инъекция через специальные методы, сеттеры

**CDI (Contexts and Dependency Injection)** - это спецификация Java EE, описывающая внедрение зависимостей и контексты.

**Компонент и контейнер** - это обычные классы. Первый требует для своей работы различные зависимости. Второй отвечает за создание объектов и их вставку.

**Прозрачность местоположения (Location transparency)** — это техника использования имен для идентификации сетевых ресурсов как таковых, а не их фактического местоположения.

## 3. Управление жизненным циклом компонентов. Дескрипторы развёртывания.

Контейнер берет на себя задачу управления жизненным циклом компонентов.

**Жизненный цикл компонентов**:
1. Создается экземпляра компонента при помощи вызова конструктора.
2. Выполняется его внедрение в необходимые компоненты.
3. Контейнер уничтожает экземпляр и все зависимые от него объекты.

**Дескриптор развертывания (Deployment descriptor)** представляет собой xml-файл, предназначенный для хранения основных параметров приложения.
Содержит информацию, которая необходима web-контейнеру для взаимодействия с приложением.

Пример дескриптора приложения с инициализацией сервлета:
```java
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
         http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
         version="3.1">
    <servlet>
        <servlet-name>AlexeiEgoshinOneLove</servlet-name>
        <servlet-class>ru.cupofcode.AlexeiEgoshinOneLoveServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>AlexeiEgoshinOneLove</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>
</web-app>
```
## 4. Java EE API. Виды компонентов. Профили платформы Java EE.

_Java EE API описаны в ответе **#1**._

**Профиль** — это набор технологий и API Java EE, предназначенных для конкретных сообществ разработчиков и типов приложений.

Реализации профилей:
* Полный профиль: предназначен для разработчиков, которым требуется полный набор API Java EE для создания корпоративных приложений.
* Веб-профиль: содержит веб-технологии, являющиеся частью полной платформы, и предназначен для разработчиков, которым не требуется полный набор API Java EE.

## 5. Компоненты EJB. Stateless & Stateful Session Beans. EJB Lite и EJB Full.

**EJB (Enterprise Java Bean)** — это спецификация для разработки серверных компонентов, реализующих бизнес-логику.

**Компоненты** — бобы, которые делятся на _session beans_ (сессионные) и _message driven beans_ (управляемые сообщениями).

Наиболее важное различие между компонентами, управляемыми сообщениями, и сессионными заключается в том, что клиенты не получают доступ к компонентам, управляемым сообщениями, через интерфейсы. 

Типы **Session beans**:
* Stateful: у каждого клиента свой экземпляр, в котором хранится состояние
* Stateless: один и тот же экземпляр обеспечивает запросы нескольких клиентов (такие бины лучше масштабируются, но не могут сохранять состояние между последовательными запросами пользователя)
* Singleton: один экземпляр для всего приложения

**Message driven beans** выполняют метод в ответ на получение сообщения из определенной очереди Java Message Service (стандарт обмена сообщениями между приложениями). Когда приходит сообщение, контейнер вызывает метод `onMessage` компонента, управляемого сообщениями, для обработки сообщения.

Аннотация `@EJB` предоставляет клиентам не сам объект, а прокси, через который можно получить доступ к методам бизнес-интерфейсов. Может осуществляться доступ как к локальным, так и удаленным (в другой JVM) объектам.

**EJB Lite** - это упрощенная спецификация EJB, которая предусматривает размещение в Web Container с урезанным функционалом. В ней отсутствуют: MDB, EJB2.x, Remote Interface, JAX-WS, JAX-RPC, Timer Service, Asynchronous Session Bean, RMI-IIOP.

## 6. Работа с электронной почтой в Java EE. JavaMail API.

**JavaMail API** - это библиотека, предназначенная для подключения к почтовым серверам с целью получения и отправки электронной почты с использованием протоколов SMTP, POP3 и IMAP.

Краткое описание поддерживаемых протоколов:
* SMTP (Simple Mail Transfer Protocol) - это простой протокол, используемый для рассылки писем.
* POP3 (Post Office Protocol Version 3) - это протокол, используемый для чтения писем. POP3 при загрузке письма на клиентский компьютер удаляет письмо с почтового сервера. Недостатком этого протокола является то, что при просмотре письма на одном клиентском компьютере это письмо уже нельзя будет посмотреть с другого устройства.
* IMAP (Internet Message Access Protocol) — это протокол доступа к электронной почте. Альтернатива протоколу POP3. IMAP подгружает на клиент только мета-информацию письма, а остальные данные предоставляет по требованию.

**MIME-типы (Multipurpose Internet Mail Extensions)** используются для обозначения типа передаваемого контента. Тип определяется двумя словами, записанными через слеш. Первое слово — это общий тип, а второе — уточнение. К примеру, `image/jpeg`.

Пример создания и отправки сообщения с помощью JavaMail API:
```java
try {
  // Создание объекта сообщения и его настройка
  // Создание объекта сессии отличается в зависимости от выбранного протокола (не представлено в примере)
  MimeMessage message = new MimeMessage(session);
  // Адрес отправителя
  message.setFrom(new InternetAddress("vipoliakov@itmo.ru"));
  // Адреса получателей
  message.addRecipient(Message.RecipientType.TO, new InternetAddress("meldren@itmo.ru"));
  // Тема сообщения
  message.setSubject("ДЗ #1");
  // Текст сообщения
  message.setText("Принято.");

  // Отправка сообщения
  Transport.send(message);
} catch (MessagingException ex) {
  ex.printStackTrace();
}
```

## 7. JMS. Реализация очередей сообщений. Способы доставки сообщений до клиента. Message-Driven Beans.

**JMS (Java Message Service)** — это стандарт для асинхронного распределенного взаимодействия программных компонентов путем рассылки сообщений.

JMS поддерживает две модели коммуникации: _point-to-point_ и _publish-subcribe (pubsub)_.

В **point-to-point** сообщения от разных отправителей адресуются в определенной очереди, к которой подключаются клиенты. При этом для каждого сообщения гарантируется, что оно будет доставлено одному и только одному клиенту.

В **pubsub** сообщения адресуются определенному topic'у, на которого подписываются клиенты. Каждое сообщение может быть получено несколькими клиентами или не получено вообще, если подписчиков на момент доставки не было.

Примеры реализаций JMS провайдеров:
* RabbitMQ
* Open Message Queue
* Apache ActiveMQ
* JBoss Messaging

_Message driven beans описаны в ответе **#5**._

## 8. Понятие транзакции. Управление транзакциями в Java EE. JTA.

**Транзакция** — это группа последовательных операций, которая образует логическую единицу работы с данными. Транзация либо выполняется успешно и целиком, соблюдая целостность данных, либо не производит никакого эффекта на данные.

**JTA (Java Transaction API)** позволяет выполнять распределенные транзакции, т.е. транзакции, оперирующие данными на разных сетевых ресурсах (серверы баз данных, JMS).

JTA предоставляет высокоуровневый интерфейс для управления транзакциями (через методы `begin`, `commit`, `rollback`), избавляя разработчика от необходимости работы с каждым ресурсом по-своему.

Транзация координируется transaction manager'ом. Взаимодействие с ресурсами осуществляется через resource manager'ы.

Виды объявления транзакций:
* Декларативно: аннотацией `@Transactional` на методе или всем классе (rollback происходит при выбрасывании необработанной `RuntimeException`)
* Программно: вызвав `begin`, `rollback`, `commit` у `UserTransaction` (интерфейс для ручного управления транзакциями)

## 9. Веб-сервисы. Технологии JAX-RS и JAX-WS.

**Веб-сервис** - это программы, которые могут взаимодействовать друг с другом и со сторонними приложениями посредством сообщений, основанных на определённых протоколах.

Основные стандарты веб-сервисов:
* SOAP (Simple Object Access Protocol): перед вызовом удаленной процедуры необходимо описать вызов в XML файле формата SOAP. По сути является еще одной из многочисленных XML разметок, которая используется в веб-сервисах. Все, что мы хотим куда-то отправить через HTTP, сначала превращается в XML описание SOAP, потом засовывается в HTTP пакет и посылается на другой компьютер в сети по TCP/IP.
* WSDL (Web Services Description Language): стандарт, который требует, чтобы наличие описания веб-сервиса, в котором сказано, что «да, вы не ошиблись – это действительно веб-сервис и можно у него вызвать такие-то такие-то методы». Такое описание представляется еще одним файлом XML, который имеет формат WSDL. То есть WSDL – это просто XML файл описания веб-сервиса.

_JAX-WS_ и _JAX-RS_ - это мощные API для разработки веб-сервисов, предоставляемые Java.

Основные отличия:
| **JAX-WS** | **JAX-RS** |
|:---:|:---:|
| В качестве основного метода связи используется SOAP | Используется архитектурная структура Restful для связи между клиентом и сервером |
| Взаимодействует посредством сообщений в формате XML | Может взаимодействовать через XML, HTML, JSON и HTTP |
| В основном используется для создания веб-сервисов на уровне предприятия, где есть строгие форматы данных, которые необходимо соблюдать | В основном используется в приложениях для смартфонов и для веб-интеграции |

## 10. Платформа Spring. Сходства и отличия с Java EE.

**Spring Framework** представляет собой контейнер внедрения зависимостей с несколькими удобными слоями (например: доступ к базе данных, прокси, аспектно-ориентированное программирование, RPC, веб-инфраструктура MVC). Все это позволяет быстрее и удобнее создавать Java-приложения.

Проведём небольшое сравнение Java EE и Spring.

| Java EE |
| Преимущества | Недостатки |
|:---:|:---:|
| Приложения, написанные на Java EE, считаются более надежными, безопасными и масштабируемыми | Очень сложная среда разработки приложений, которую сложно понять новичкам (и старичкам порой тоже) |
| Утвержденный промышленностью стандарт API | Окончательная стоимость проекта, включая разработку, развертывание и разработку приложений, может оказаться непомерно высокой |
| Преимущественно основан на аннотациях и CDI, как впрочем и Spring |  |
| Реализация на основе EJB контейнеров и POJO |   |
| Сложные приложения с большим количеством транзакций очень хорошо обрабатываются |   |
| Успешен в использовании для масштабируемого монолитного приложения |   |
| У Java EE есть свой ООП язык, содержащий определенный стиль и синтаксис |
