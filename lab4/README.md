# Ответы на вопросы к защите лабораторной работы

## 1. Платформа Java EE. Спецификации и их реализации.

**Java EE (Java Enterprise Edition)** представляет собой платформу для создания корпоративных приложений на языке Java. Прежде всего это сфера веб-приложений и веб-сервисов.

Основные спецификации:
* **Java Servlets**: серверные модули, которые обрабатывают запросы от пользователей и отправляют результат обработки.
* **JavaServer Pages (JSP)**: серверные модули для обработки пользовательских запросов (по сути предствляют собой страницы с кодом HTML/JavaScript/CSS с вкраплениями кода на Java).
* **Enterprise JavaBeans (EJB)**: Java классы, которые содержат бизнес-логику.
* **Contexts and Dependency Injection (CDI)**: механизм для внедрения и управления зависимостями.
* **JavaServer Faces (JSF)**: служит для создания пользовательского интерфейса на стороне сервера.
* **Java API for RESTful Web Services (JAX-RS)**: API для применения архитектуры REST в приложениях.

Основные реализации:
* Wildfly
* Glassfish

## 2. Принципы IoC, CDI и Location Transpanency. Компоненты и контейнеры.

**Inversion of Control** - это принцип для написания слабо связанного кода. То есть такого кода, что каждый компонент системы должен быть как можно более изолированным от других, не используя реализации других компонентов.

**Внедрение зависимостей (Dependency Injection)** - это стиль настройки объекта, при котором поля объекта задаются внешней сущностью. Другими словами, объекты настраиваются внешними объектами. Звучит довольно абстрактно, лучше показать на примере:

```java
public class MartinRaila {

  // В данном случае мы самостоятельно управляем зависимостью (создаем ее).
  private Dependency someDependency = new Dependency();
  
}
```
Перепишем код с использованием принципа внедрения зависимостей.
```java
public class MartinRaila {

  private Dependency someDependency;

  // Теперь мы принимаем зависимость извне, что избавляет компонент от необходимости ею управлять
  public MartinRaila(Dependency someDependency) {
    this.someDependency = someDependency;
  }
  
}  
```

Существует 3 типа внедрения зависимостей:
* Field injection: инъекция напрямую в поле.
* Constructor injection: инъекция конструктор (как показано в примере выше).
* Setter injection: инъекция через специальные методы, сеттеры

**CDI (Contexts and Dependency Injection)** - это спецификация Java EE, описывающая внедрение зависимостей и контексты.

**Компонент и контейнер** - это обычные классы. Первый требует для своей работы различные зависимости. Второй отвечает за создание объектов и их вставку.

**Прозрачность местоположения (Location transparency)** — это техника использования имен для идентификации сетевых ресурсов как таковых, а не их фактического местоположения.

## 3. Управление жизненным циклом компонентов. Дескрипторы развёртывания.

Контейнер берет на себя задачу управления жизненным циклом компонентов.

**Жизненный цикл компонентов**:
1. Создается экземпляра компонента при помощи вызова конструктора.
2. Выполняется его внедрение в необходимые компоненты.
3. Контейнер уничтожает экземпляр и все зависимые от него объекты.

**Дескриптор развертывания (Deployment descriptor)** представляет собой xml-файл, предназначенный для хранения основных параметров приложения.
Содержит информацию, которая необходима web-контейнеру для взаимодействия с приложением.
Пример дескриптора приложения с инициализацией сервлета:
```java
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
         http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
         version="3.1">
    <servlet>
        <servlet-name>AlexeiEgoshinOneLove</servlet-name>
        <servlet-class>ru.cupofcode.AlexeiEgoshinOneLoveServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>AlexeiEgoshinOneLove</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>
</web-app>
```
## 4. Java EE API. Виды компонентов. Профили платформы Java EE.

_Java EE API описаны в вопросе **#1**._

**Профиль** — это набор технологий и API Java EE, предназначенных для конкретных сообществ разработчиков и типов приложений.

Реализации профилей:
* Полный профиль: предназначен для разработчиков, которым требуется полный набор API Java EE для создания корпоративных приложений.
* Веб-профиль: содержит веб-технологии, являющиеся частью полной платформы, и предназначен для разработчиков, которым не требуется полный набор API Java EE.

## 5. Компоненты EJB. Stateless & Stateful Session Beans. EJB Lite и EJB Full.

EJB (Enterprise Java Bean) — спецификация для разработки серверных компонентов, реализующих бизнес-логику.

Компоненты — бобы, которые делятся на _session beans_ (заседательные бобы) и _message driven beans_ (бобы, движимые посланиями).

_Session beans_ в свою очередь делятся на:
* _stateful_: у каждого клиента своя инстанция, в которой хранится его состояние
* _stateless_: одна и та же инстанция обеспечивает запросы нескольких клиентов => лучше масштабируются, но не могут сохранять состояние между последовательными обращениями клиента
* _singleton_: одна инстанция на все приложение => общее для всех клиентов состояние

_Message driven beans_ выполняют метод в ответ на получение сообщения из определенной очереди JMS.

Аннотация `@EJB` предоставляет клиентам не сам объект, а прокси, через который можно получить доступ к методам бизнес-интерфейсов. Может осуществляться доступ как к локальным, так и удаленным (в другой JVM) объектам.

## 7. JMS. Реализация очередей сообщений. Способы доставки сообщений до клиента. Message-Driven Beans.

Java Message Service — стандарт для асинхронного распределенного взаимодействия программных компонентов (которые могут находиться на одном компьютере, в одной локальной сети, или быть связаны через Интернет) путем рассылки сообщений.

JMS поддерживает две модели коммуникации: _point-to-point_ и _publish-subcribe (pubsub)_.

В _point-to-point_ сообщения от разных отправителей адресуются определенной очереди, к которой подключаются клиенты. При этом для каждого сообщения гарантируется, что оно будет доставлено одному и только одному клиенту.

В _pubsub_ сообщения адресуются определенному topic'у, на которые подписываются клиенты. Каждое сообщение может быть получено несколькими клиентами или не получено вообще, если подписчиков на момент доставки не было.

Существует несколько реализаций JMS провайдеров (RabbitMQ, Open Message Queue, ...)

## 8. Понятие транзакции. Управление транзакциями в Java EE. JTA.

Транзакция — группа последовательных операций, представляет собой логическую единицу работы с данными. Транзация либо выполняется успешно и целиком, соблюдая целостность данных, либо не производит никакого эффекта на данные.

_Java Transaction API_ позволяет выполнять распределенные транзакции, т.е. транзакции, читающие и обновляющие данные на разных сетевых ресурсах (которыми могут быть различные серверы баз данных, JMS).

JTA предоставляет высокоуровневый интерфейс для управления транзакиями (begin, commit, rollback), избавляя от необходимости работы с каждым ресурсом по-своему (интерфейс транзакций в JDBC, например, немного отличается от интерфейса JMS).

Транзация координируется transaction manager'ом. Взаимодействие с ресурсами осуществляется через resource manager'ы.

Транзакции могут быть объявлены:
* декларативно — аннотацией `@Transactional` на отдельном методе или всем классе, при этом rollback происходит при необработанном `RuntimeException`
* программно — вызывая `begin`, `rollback`, `commit` у [`UserTransaction`](https://docs.oracle.com/javaee/6/api/javax/transaction/UserTransaction.html)
